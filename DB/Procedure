IF EXISTS (SELECT * FROM sysobjects WHERE type = 'P' AND name = 'Grid_ParentChild_Mapiing_IN_UTIBA')
	BEGIN
		DROP PROCEDURE [dbo].[Grid_ParentChild_Mapiing_IN_UTIBA]
	END
GO

/*

Grid_ParentChild_Mapiing_IN_UTIBA

*/ 

CREATE PROCEDURE [dbo].[Grid_ParentChild_Mapiing_IN_UTIBA] 
	
WITH ENCRYPTION
AS
SET NOCOUNT ON
BEGIN


SELECT U.ChildNumber AS Hutch
,U1.ChildNumber AS Dealer
,U2.ChildNumber AS DSR
,U3.ChildNumber AS Retailer
FROM UTIBA_ReloadMapping U
	INNER JOIN UTIBA_ReloadMapping U1 ON U1.ParentNumber = U.ChildNumber AND U1.mpt_TypeEnum = 2
	INNER JOIN UTIBA_ReloadMapping U2 ON U2.ParentNumber = U1.ChildNumber AND U2.mpt_TypeEnum = 3
	INNER JOIN UTIBA_ReloadMapping U3 ON U3.ParentNumber = U2.ChildNumber AND U3.mpt_TypeEnum = 4
ORDER BY 1,2,3
	
SET NOCOUNT OFF
END

	
